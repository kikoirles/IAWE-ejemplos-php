
/*BORRADO DE BASE DE DATOS  */

DROP DATABASE IF EXISTS PCRS;

/*CREACION DE BASE DE DATOS  */

CREATE DATABASE PCRS CHARACTER SET utf8mb4;

/*USO DE BASE DE DATOS PARA GENERAr LAS TABLAS EN DICHA BASE DE DATOS */

USE PCRS;

/*CREACION DE TABLAS  */

CREATE TABLE EMPLEADOS(
EMPLEADOID int NOT NULL,
NOMBRE char(30) NULL,
APELLIDO char(30) NULL,
FECHA_NAC date NULL,
EXTENSION int NULL,
CONSTRAINT PK_EMPLEADOS PRIMARY KEY (EMPLEADOID));

CREATE TABLE PROVEEDORES(
PROVEEDORID int NOT NULL,
NOMBREPROV char(50) NOT NULL,
CONTACTO char(50) NOT NULL,
TELPROV int(9) NULL,
FIJOPROV int(9) NULL,
CONSTRAINT PK_PROVEEDORES PRIMARY KEY (PROVEEDORID));

CREATE TABLE CATEGORIAS(
CATEGORIAID int NOT NULL,
NOMBRECAT char(50) NOT NULL,
CONSTRAINT PK_CATEGORIAS PRIMARY KEY (CATEGORIAID));

CREATE TABLE CLIENTES(
CLIENTEID int NOT NULL,
CEDULA_RUC char(10) NOT NULL,
NOMBRECIA char(30) NOT NULL,
NOMBRECONTACTO char(50) NOT NULL,
DIRECCIONCLI char(50) NOT NULL,
FAX char(12) NULL,
EMAIL char(50) NULL,
MOVIL int(9) NOT NULL,
FIJO int(9) NULL,
CONSTRAINT PK_CLIENTES PRIMARY KEY (CLIENTEID));

CREATE TABLE ORDENES(
ORDENID int NOT NULL,
EMPLEADOID int NOT NULL,
CLIENTEID int NOT NULL,
FECHAORDEN date NOT NULL,
DESCUENTO int NULL,
CONSTRAINT PK_ORDENES PRIMARY KEY (ORDENID));


CREATE TABLE DETALLE_ORDENES(
ORDENID int NOT NULL,
DETALLEID int NOT NULL,
PRODUCTOID int NOT NULL,
CANTIDAD int NOT NULL,
CONSTRAINT PK_DETALLE_ORDENES PRIMARY KEY (ORDENID,DETALLEID));

CREATE TABLE PRODUCTOS(
PRODUCTOID int NOT NULL,
PROVEEDORID int NOT NULL,
CATEGORIAID int NOT NULL,
DESCRIPCION char(50) NULL,
PRECIOUNIT numeric NOT NULL,
EXISTENCIA int NOT NULL,
CONSTRAINT PK_PRODUCTOS PRIMARY KEY (PRODUCTOID)) ;

CREATE TABLE MARCA(
MARCAID int NOT NULL,
NOMBREMAR char(50) NOT NULL,
PRODUCTOID int NOT NULL,
CONSTRAINT PK_MARCASID PRIMARY KEY (MARCAID)) ;

CREATE TABLE PAGOS(
PAGOID int NOT NULL,
PROVEEDORID int NOT NULL,
CANTIDADP smallint NOT NULL,
CONSTRAINT PK_PAGO PRIMARY KEY (PAGOID)) ;

CREATE TABLE SALARIOS(
SALARIOID int NOT NULL,
EMPLEADOID int NOT NULL, 
CANTIDADS smallint NOT NULL,
CONSTRAINT PK_SALARIO PRIMARY KEY (SALARIOID)) ;

CREATE TABLE GASTOS(
GASTOID int NOT NULL,
FEHCAGASTOS date NOT NULL,
PAGOID int NOT NULL,
SALARIOID int NOT NULL,
CONSTRAINT PK_GASTO PRIMARY KEY (GASTOID)) ;

/*MODIFICAR MOTORES DE TABALS */
										/*PREDOMINA imnoDB ya que puede haber conexiones simultaneas a nuestra base de datos por pora aparte de los empelados y por modificaciones */
ALTER TABLE EMPLEADOS ENGINE=InnoDB;
ALTER TABLE PROVEEDORES ENGINE=InnoDB;
ALTER TABLE CATEGORIAS ENGINE=InnoDB;  /*Debido a que existen pocas categorias y solo se realizaran consultas Podemos usar MyISAM y no se modifican datos frecuentemente pero nos proporcionaria un error si usamo MyISAN cpor la claver alternativa por eso se queda en innoDB */  
ALTER TABLE CLIENTES ENGINE=InnoDB; 
ALTER TABLE ORDENES ENGINE=InnoDB;
ALTER TABLE DETALLE_ORDENES ENGINE=InnoDB;
ALTER TABLE PRODUCTOS ENGINE=InnoDB;
ALTER TABLE MARCA ENGINE=MyISAM;
ALTER TABLE PAGOS ENGINE=InnoDB;
ALTER TABLE SALARIOS ENGINE=InnoDB;
ALTER TABLE GASTOS ENGINE=InnoDB;

/*MODIFICACION DE CLAVES AJENAS  */

ALTER TABLE ORDENES ADD CONSTRAINT FK_ORDENES_CLIEN_ORD_CLIENTES FOREIGN KEY(CLIENTEID)
REFERENCES CLIENTES (CLIENTEID)
on delete restrict on update restrict;

ALTER TABLE ORDENES ADD CONSTRAINT FK_ORDENES_EMPLE_ORD_EMPLEADO FOREIGN KEY(EMPLEADOID)
REFERENCES EMPLEADOS (EMPLEADOID)
on delete restrict on update restrict;

ALTER TABLE DETALLE_ORDENES ADD CONSTRAINT FK_DETALLE__ORDEN_DET_ORDENES FOREIGN KEY(ORDENID)
REFERENCES ORDENES (ORDENID)
on delete restrict on update restrict;

ALTER TABLE DETALLE_ORDENES ADD CONSTRAINT FK_DETALLE__PROD_DETA_PRODUCTO FOREIGN KEY(PRODUCTOID)
REFERENCES PRODUCTOS (PRODUCTOID)
on delete restrict on update restrict;

ALTER TABLE PRODUCTOS ADD CONSTRAINT FK_PRODUCTO_CATE_PROD_CATEGORI FOREIGN KEY(CATEGORIAID)
REFERENCES CATEGORIAS (CATEGORIAID)
on delete restrict on update restrict;

ALTER TABLE PRODUCTOS ADD CONSTRAINT FK_PRODUCTO_PROV_PROD_PROVEEDO FOREIGN KEY(PROVEEDORID)
REFERENCES PROVEEDORES (PROVEEDORID)
on delete restrict on update restrict;

ALTER TABLE MARCA ADD CONSTRAINT FK_MARCAS_PRODUCT FOREIGN KEY(PRODUCTOID)
REFERENCES PRODUCTOS (PRODUCTOID)
on delete restrict on update restrict;

ALTER TABLE PAGOS ADD CONSTRAINT FK_PAGO_PROVEEDO FOREIGN KEY(PROVEEDORID)
REFERENCES PROVEEDORES (PROVEEDORID)
on delete restrict on update restrict;

ALTER TABLE SALARIOS ADD CONSTRAINT FK_SALARIO_EMPELAD FOREIGN KEY(EMPLEADOID)
REFERENCES EMPLEADOS (EMPLEADOID)
on delete restrict on update restrict;

ALTER TABLE GASTOS ADD CONSTRAINT FK_GASTO_PAGO FOREIGN KEY(PAGOID)
REFERENCES PAGOS (PAGOID)
on delete restrict on update restrict;

ALTER TABLE GASTOS ADD CONSTRAINT FK_MARCA_SALARIO FOREIGN KEY(SALARIOID)
REFERENCES SALARIOS (SALARIOID)
on delete restrict on update restrict;


/*INSERCIÃ“N DE DATOS EN LA BASE */

INSERT INTO CATEGORIAS  VALUES (100, 'ORDENADORES');
INSERT INTO CATEGORIAS  VALUES (200, 'IMPRESORAS');
INSERT INTO CATEGORIAS  VALUES (300, 'MEMORIAS');
INSERT INTO CATEGORIAS  VALUES (400, 'DISCOS');
INSERT INTO CATEGORIAS  VALUES (500, 'SERVIDORES');
INSERT INTO CATEGORIAS  VALUES (600, 'CPDS');
INSERT INTO CATEGORIAS  VALUES (700, 'SWITCHES');

INSERT INTO PROVEEDORES VALUES (10, 'DON DIEGO', 'MANUEL ANDRADE',099234567,2124456);
INSERT INTO PROVEEDORES VALUES (20, 'PRONACA', 'JUAN PEREZ',0923434467,2124456);
INSERT INTO PROVEEDORES VALUES (30, 'TONY', 'JORGE BRITO',099234567,2124456);
INSERT INTO PROVEEDORES VALUES (40, 'MIRAFLORES', 'MARIA PAZ',098124498,2458799);
INSERT INTO PROVEEDORES VALUES (50, 'ALMAY', 'PEDRO GONZALEZ',097654567,2507190);
INSERT INTO PROVEEDORES VALUES (60, 'REVLON', 'MONICA SALAS',099245678,2609876);
INSERT INTO PROVEEDORES VALUES (70, 'YANBAL', 'BETY ARIAS',098124458,2450887);
INSERT INTO PROVEEDORES VALUES (120, 'JURIS', 'MANUEL ANDRADE',099234567,2124456);
INSERT INTO PROVEEDORES VALUES (80, 'CLEANER', 'MANUEL ANDRADE',099234567,2124456);
INSERT INTO PROVEEDORES VALUES (90, 'BAYER', 'MANUEL ANDRADE',099234567,2124456);
INSERT INTO PROVEEDORES VALUES (110, 'PALMOLIVE', 'MANUEL ANDRADE',099234567,2124456);

INSERT INTO PRODUCTOS VALUES (1,10,100,'HONOR MAGICBOOK 148 LG ',2.60,200);
INSERT INTO PRODUCTOS VALUES (2,10,100,'HUAWEI MATEBOOK X PRO',3.60,300);
INSERT INTO PRODUCTOS VALUES (3,10,100,'LENOVO YOGA C740 ',4.70,400);
INSERT INTO PRODUCTOS VALUES (4,20,100,'ASUS ZENBOOK S13',2.90,200);
INSERT INTO PRODUCTOS VALUES (5,20,100,'DELL XPS 15',2.80,100);
INSERT INTO PRODUCTOS VALUES (6,30,200,'CANON PIXMA IX6850',4.30,80);
INSERT INTO PRODUCTOS VALUES (7,30,200,'CANON SELPHY CP1300',1.60,90);
INSERT INTO PRODUCTOS VALUES (8,40,200,'HP OFFICEJET PRO 6230 EPRINT',1.60,200);
INSERT INTO PRODUCTOS VALUES (9,40,200,'HP OFFICEJET PRO 8210',3.60,30);
INSERT INTO PRODUCTOS VALUES (10,50,600,'DELL POWEREDGE R540',14.70,40);
INSERT INTO PRODUCTOS VALUES (11,50,600,'DELL POWEREDGE R567',12.90,20);
INSERT INTO PRODUCTOS VALUES (13,60,600,'DELL POWEREDGE R598',9.80,100);


INSERT INTO EMPLEADOS VALUES (1,'JUAN', 'CRUZ','1996-01-29', 231);
INSERT INTO EMPLEADOS VALUES (2,'MARIO', 'SANCHEZ','1967-01-29',144);
INSERT INTO EMPLEADOS VALUES (3,'VERONICA', 'ARIAS', '2005-06-16', 234);
INSERT INTO EMPLEADOS VALUES (4,'PABLO', 'CELY', '2010-01-12', 567);
INSERT INTO EMPLEADOS VALUES (5,'DIEGO', 'ANDRADE', '2000-05-13', 890);
INSERT INTO EMPLEADOS VALUES (6,'JUAN', 'ANDRADE', '1999-11-21', 230);
INSERT INTO EMPLEADOS VALUES (7,'MARIA', 'NOBOA', '2012-12-11', 261);

INSERT INTO CLIENTES VALUES (1,'1890786576','SUPERMERCADO ESTRELLA','JUAN ALBAN','AV.AMAZONAS',NULL,NULL,099234567,NULL);
INSERT INTO CLIENTES VALUES (2,'1298765477','EL ROSADO','MARIA CORDERO','AV.AEL INCA',NULL,NULL,099234565,NULL);
INSERT INTO CLIENTES VALUES (3,'1009876567','DISTRIBUIDORA PRENSA','PEDRO PINTO','EL PINAR',NULL,NULL,099234566,NULL);
INSERT INTO CLIENTES VALUES (4,'1876090006','SU TIENDA','PABLO PONCE','AV.AMAZONAS',NULL,NULL,099234564,NULL);
INSERT INTO CLIENTES VALUES (5,'1893456776','SUPERMERCADO DORADO','LORENA PAZ','AV.6 DICIEMBRE',NULL,NULL,099234563,NULL);
INSERT INTO CLIENTES VALUES (6,'1678999891','MI COMISARIATO','ROSARIO UTRERAS','AV.AMAZONAS',NULL,NULL,099234562,NULL);
INSERT INTO CLIENTES VALUES (7,'1244567888','SUPERMERCADO DESCUENTO','LETICIA ORTEGA','AV.LA PRENSA',NULL,NULL,099234561,NULL);
INSERT INTO CLIENTES VALUES (8,'1456799022','EL DESCUENTO','JUAN TORRES','AV.PATRIA',NULL,NULL,099234517,NULL);
INSERT INTO CLIENTES VALUES (9,'1845677777','DE LUISE','JORGE PARRA','AV.AMAZONAS',NULL,NULL,099233567,NULL);
INSERT INTO CLIENTES VALUES (10,'183445667','YARBANTRELLA','PABLO POLIT','AV.REPUBLICA',NULL,NULL,099284567,NULL);

INSERT INTO ORDENES VALUES (1,3,4,'1723-06-07', 5);
INSERT INTO ORDENES VALUES (2,3,4,'2002-06-07', 10);
INSERT INTO ORDENES VALUES (3,4,5,'2005-06-07', 6);
INSERT INTO ORDENES VALUES (4,2,6,'2006-06-07', 2);
INSERT INTO ORDENES VALUES (5,2,7,'2009-06-07', NULL);
INSERT INTO ORDENES VALUES (6,4,5,'2012-06-07', 10);
INSERT INTO ORDENES VALUES (7,2,5,'2014-06-07', 10);
INSERT INTO ORDENES VALUES (8,3,2,'2013-06-07', 10);
INSERT INTO ORDENES VALUES (9,3,2,'2017-06-07', 3);
INSERT INTO ORDENES VALUES (10,2,2,'2018-06-07', 2);

INSERT INTO DETALLE_ORDENES VALUES (1,1,1,2);
INSERT INTO DETALLE_ORDENES VALUES (1,2,4,1);
INSERT INTO DETALLE_ORDENES VALUES (1,3,6,1);
INSERT INTO DETALLE_ORDENES VALUES (1,4,9,1);
INSERT INTO DETALLE_ORDENES VALUES (2,1,10,10);
INSERT INTO DETALLE_ORDENES VALUES (2,2,13,20);
INSERT INTO DETALLE_ORDENES VALUES (3,1,3,10);
INSERT INTO DETALLE_ORDENES VALUES (4,1,9,12);
INSERT INTO DETALLE_ORDENES VALUES (5,1,1,14);
INSERT INTO DETALLE_ORDENES VALUES (5,2,4,20);
INSERT INTO DETALLE_ORDENES VALUES (6,1,3,12);
INSERT INTO DETALLE_ORDENES VALUES (7,1,11,10);
INSERT INTO DETALLE_ORDENES VALUES (8,1,2,10);
INSERT INTO DETALLE_ORDENES VALUES (8,2,5,14);
INSERT INTO DETALLE_ORDENES VALUES (8,3,7,10);
INSERT INTO DETALLE_ORDENES VALUES (9,1,11,10);
INSERT INTO DETALLE_ORDENES VALUES (10,1,1,5);

INSERT INTO MARCA VALUES (1, 'HONOR',1);
INSERT INTO MARCA VALUES (2, 'HUAWEI',2);
INSERT INTO MARCA VALUES (3, 'LENOVO',3);
INSERT INTO MARCA VALUES (4, 'ASUS',4);
INSERT INTO MARCA VALUES (5, 'DELL',5);
INSERT INTO MARCA VALUES (6, 'CANON',6);
INSERT INTO MARCA VALUES (7, 'HP',8);

INSERT INTO PAGOS VALUES (1,10,1343);
INSERT INTO PAGOS VALUES (2,20,1242);
INSERT INTO PAGOS VALUES (3,30,1622);
INSERT INTO PAGOS VALUES (4,40,1863);
INSERT INTO PAGOS VALUES (5,50,1414);
INSERT INTO PAGOS VALUES (6,60,1278);
INSERT INTO PAGOS VALUES (7,70,1123);

INSERT INTO SALARIOS VALUES (1,1,1000);
INSERT INTO SALARIOS VALUES (2,2,1000);
INSERT INTO SALARIOS VALUES (3,3,1000);
INSERT INTO SALARIOS VALUES (4,4,1000);
INSERT INTO SALARIOS VALUES (5,5,1000);
INSERT INTO SALARIOS VALUES (6,6,1000);
INSERT INTO SALARIOS VALUES (7,7,1000);

INSERT INTO GASTOS VALUES (1,'13-06-07', 1,1);
INSERT INTO GASTOS VALUES (2,'14-12-08', 2,2);
INSERT INTO GASTOS VALUES (3,'23-06-09', 3,3);
INSERT INTO GASTOS VALUES (4,'15-09-10', 4,4);
INSERT INTO GASTOS VALUES (5,'21-11-12', 5,5);
INSERT INTO GASTOS VALUES (6,'12-10-11', 6,6);
INSERT INTO GASTOS VALUES (7,'02-07-13', 7,7);


/* BORRAR USUARIOS*/
DROP USER IF EXISTS'administrador'@'localhost';

DROP USER IF EXISTS'ventas'@'192.168.0.125';
DROP USER IF EXISTS'almacen'@'192.168.0.125';
DROP USER IF EXISTS'contable'@'192.168.0.125';
DROP USER IF EXISTS'pedidos'@'192.168.0.125';

DROP USER IF EXISTS'ventas'@'192.168.0.124';
DROP USER IF EXISTS'almacen'@'192.168.0.124';
DROP USER IF EXISTS'contable'@'192.168.0.124';
DROP USER IF EXISTS'pedidos'@'192.168.0.124';

FLUSH PRIVILEGES;

/* PROCEDEMOS A EDITAR LOS PERMISOS DE LOS LOS ROLES */
/* ROL VENTAS PERMISO DE INSERTAR,ACTUALIZAR.BORRAR REGISTROS EN LA TABLA PRODUCTOS Y PROVEEDORES */
GRANT INSERT,UPDATE,SELECT,DELETE ON PCRS . ORDENES TO 'rolventas';
GRANT INSERT,UPDATE,SELECT,DELETE ON PCRS . CLIENTES TO 'rolventas';
GRANT INSERT,UPDATE,SELECT,DELETE ON PCRS . DETALLE_ORDENES TO 'rolventas';
/* ROL ALMACEN PERMISO DE INSERTAR,ACTUALIZAR.BORRAR REGISTROS EN LA TABLA PRODUCTOS Y PROVEEDORES */
GRANT INSERT,UPDATE,SELECT,DELETE ON PCRS . PRODUCTOS TO 'rolalmacen';
GRANT INSERT,UPDATE,SELECT,DELETE ON PCRS . MARCA TO 'rolalmacen';
/* ROL CONTABLE PERMISO DE INSERTAR,ACTUALIZAR.BORRAR REGISTROS EN LA TABLA PRODUCTOS Y PROVEEDORES */
GRANT INSERT,UPDATE,SELECT,DELETE ON PCRS . PAGOS TO 'rolcontable';
GRANT INSERT,UPDATE,SELECT,DELETE ON PCRS . SALARIOS TO 'rolcontable';
/* ROL PEDIDOS PERMISO DE INSERTAR,ACTUALIZAR.BORRAR REGISTROS EN LA TABLA PRODUCTOS Y PROVEEDORES */
GRANT INSERT,UPDATE,SELECT,DELETE ON PCRS . PRODUCTOS TO 'rolpedidos';
GRANT INSERT,UPDATE,SELECT,DELETE ON PCRS . PROVEEDORES TO 'rolpedidos';

FLUSH PRIVILEGES;

/*CREACION DE USUARIOS Y AÃ‘ADIENDOLOS A SU ROL ESPECIFICADO */
/*CREACION DE USUARIO ADMINISTRADOR  */

CREATE USER 'administrador'@'localhost' IDENTIFIED BY 'barcelona223-' REQUIRE SSL;
GRANT ALL PRIVILEGES ON PCRS . * TO 'administrador'@'localhost';

FLUSH PRIVILEGES;

/*CREACION DE USUARIO VENTAS  */

CREATE USER 'ventas'@'192.168.0.125' IDENTIFIED BY 'ventas223-' REQUIRE SSL;
CREATE USER 'ventas'@'192.168.0.124' IDENTIFIED BY 'ventas223-' REQUIRE SSL;


FLUSH PRIVILEGES;

/*CREACION DE USUARIO ALMACEN  */

CREATE USER 'almacen'@'192.168.0.125' IDENTIFIED BY 'almacen223-' REQUIRE SSL;
CREATE USER 'almacen'@'192.168.0.124' IDENTIFIED BY 'almacen223-' REQUIRE SSL;


FLUSH PRIVILEGES;

/*CREACION DE USUARIO CONTABLE  */

CREATE USER 'contable'@'192.168.0.124' IDENTIFIED BY 'contable223-' REQUIRE SSL;
CREATE USER 'contable'@'192.168.0.125' IDENTIFIED BY 'contable223-' REQUIRE SSL;


FLUSH PRIVILEGES;

/*CREACION DE USUARIO PEDIDO */

CREATE USER 'pedidos'@'192.168.0.124' IDENTIFIED BY 'pedidos223-' REQUIRE SSL;
CREATE USER 'pedidos'@'192.168.0.125' IDENTIFIED BY 'pedidos223-' REQUIRE SSL;


FLUSH PRIVILEGES;


/*FUERA DEL ROL YA LE PODEMOS PONER LOS PERMISOS QUE DESEMOS */

GRANT SELECT,INSERT ON PCRS . PAGOS TO 'contable'@'192.168.0.124';
GRANT SELECT,INSERT ON PCRS . SALARIOS TO 'contable'@'192.168.0.124';
GRANT SELECT,INSERT ON PCRS . PAGOS TO 'contable'@'192.168.0.125';
GRANT SELECT,INSERT ON PCRS . SALARIOS TO 'contable'@'192.168.0.125';

FLUSH PRIVILEGES;

/*SIMPLE VISTA PARA MOSTRAR A QUE EMPLEADO LA CANTIDAD DE SALIO QUE SE A REGISTADO */  

CREATE VIEW VISTA_PAGOS_EMPELADOS (EMPLEADOID, CANTIDADS, NOMBRE, PELLIDO) 
AS SELECT s.EMPLEADOID, s.CANTIDADS, en.NOMBRE, en.APELLIDO 
FROM SALARIOS s, EMPLEADOS en WHERE s.EMPLEADOID = en.EMPLEADOID; 

/*SIMPLE VISTA PARA MOSTRAR QUE PROEVEEDOR LA CANTIDAD DE PAGO QUE SE LE A REALIZADO QUE SE A REGISTRADO */  

CREATE VIEW VISTA_PAGOS_PROVEDORES (PROVEEDORID, CANTIDADP, NOMBREPROV, TELEFONO) 
AS SELECT p.PROVEEDORID, p.CANTIDADP, po.NOMBREPROV, po.TELPROV 
FROM PAGOS p, PROVEEDORES po WHERE p.PROVEEDORID = po.PROVEEDORID; 


/*VISTA QUE OCULTA INFORMACION A LOS USUARIOS DEL ROL (en este caso es una consulta muy simple pero ocultamos valores de la tabla original obtneniendo los datos que deseamos) */ 

CREATE VIEW LISTA_PRODUCTOS(MARCA, MODELO, CANTIDAD) 
AS SELECT m.NOMBREMAR, p.DESCRIPCION, p.EXISTENCIA 
FROM MARCA m JOIN PRODUCTOS p ON m.PRODUCTOID = p.PRODUCTOID; 

/*VISTA PARA AÃ‘ADIR DATOS PORVEEDORES PAGADOS */  

CREATE VIEW VISTA_AÃ‘ADIR_PAGOS_PROVEDORES (PROVEEDORID, CANTIDADP, NOMBREPROV, TELEFONO) 
AS SELECT p.PROVEEDORID, p.CANTIDADP, po.NOMBREPROV, po.TELPROV 
FROM PAGOS p, PROVEEDORES po WHERE p.PROVEEDORID = po.PROVEEDORID; 

SELECT * FROM PCRS.VISTA_AÃ‘ADIR_PAGOS_PROVEDORES;


/*ASIGNACION DE VISTAS A ROLES DE USUARIOS */

/*USUARIOS DEL ROL CONTABLE DERECHO A VER REGISTROS DE LA VISTA */
GRANT SELECT  ON PCRS . VISTA_PAGOS_PROVEDORES TO 'pedidos'@'192.168.0.124';
GRANT SELECT  ON PCRS . VISTA_PAGOS_PROVEDORES TO 'pedidos'@'192.168.0.125';

FLUSH PRIVILEGES;

/*USUARIOS DEL ROL CONTABLE DERECHO A VER,INSERTAR,MODIFICAR,BORRAR REGISTROS DE LA VISTA   */
GRANT SELECT,INSERT,UPDATE,DELETE ON PCRS . VISTA_PAGOS_EMPELADOS TO 'contable'@'192.168.0.124';
GRANT SELECT,INSERT,UPDATE,DELETE ON PCRS . VISTA_PAGOS_EMPELADOS TO 'contable'@'192.168.0.124';

FLUSH PRIVILEGES;

/*USUARIOS DEL ROL CONTABLE DERECHO A VER,INSERTAR,MODIFICAR,BORRAR REGISTROS DE LA VISTA   */
GRANT SELECT,INSERT,UPDATE,DELETE ON PCRS . VISTA_AÃ‘ADIR_PAGOS_PROVEDORES TO 'contable'@'192.168.0.124';
GRANT SELECT,INSERT,UPDATE,DELETE ON PCRS . VISTA_AÃ‘ADIR_PAGOS_PROVEDORES TO 'contable'@'192.168.0.125';

FLUSH PRIVILEGES; 

/*CONSIDERO QUE ES UNA TaBLA QUE TODOS LOS USUSRIOS DE LA EMPRESA PUEDEN CONSULTAR (pero los usuarios del rol ventas y pedidos pueden modificar y eliminar desde dicha vista) 
Ejemplo facilita mucho la eliminacion de un producto ya no servido o una marca nueva que sale etc */
GRANT SELECT,INSERT,DELETE  ON PCRS . LISTA_PRODUCTOS TO 'rolpedidos'@'192.168.0.124';
GRANT SELECT,INSERT,DELETE  ON PCRS . LISTA_PRODUCTOS TO 'rolpedidos'@'192.168.0.125';
GRANT SELECT,INSERT,DELETE  ON PCRS . LISTA_PRODUCTOS TO 'rolventas'@'192.168.0.124';
GRANT SELECT,INSERT,DELETE  ON PCRS . LISTA_PRODUCTOS TO 'rolventas'@'192.168.0.125';
GRANT SELECT  ON PCRS . LISTA_PRODUCTOS TO 'rolalmacen'@'192.168.0.124';
GRANT SELECT  ON PCRS . LISTA_PRODUCTOS TO 'rolalmacen'@'192.168.0.125';
GRANT SELECT  ON PCRS . LISTA_PRODUCTOS TO 'rolcontable'@'192.168.0.124';
GRANT SELECT  ON PCRS . LISTA_PRODUCTOS TO 'rolcontable'@'192.168.0.125';

FLUSH PRIVILEGES;